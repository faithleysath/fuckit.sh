import { llm_config } from "../core/config.ab"
import { file_write, dir_create, dir_exists } from "std/fs"
import { env_var_get, echo_error } from "std/env"

main {
    let home_dir = trust env_var_get("HOME")
    let config_dir = home_dir + "/.fuckit"
    let config_file = config_dir + "/llm_config.env"

    // Create a dummy config file
    if not dir_exists(config_dir) {
        dir_create(config_dir)
    }
    let config_content = "FUCKIT_BASE_URL=https://api.example.com\nFUCKIT_API_KEY=test-key\nFUCKIT_MODEL_NAME=test-model"
    file_write(config_file, config_content)

    let config = llm_config() failed {
        echo_error("Failed to load LLM configuration.")
    }
    let base_url = config[0]
    let api_key = config[1]
    let model_name = config[2]

    echo "Base URL: {base_url}"
    echo "API Key: {api_key}"
    echo "Model Name: {model_name}"

    // Cleanup
    trust $ rm {config_file} $
    trust $ rmdir {config_dir} $
}
